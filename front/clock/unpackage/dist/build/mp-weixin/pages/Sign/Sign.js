"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),t=require("../../store/user.js"),r=require("../../store/time.js"),o=require("../../store/tag.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const d={__name:"Sign",setup(d){const s=e.inject("url"),n=e.reactive({userConfirm:"",flag:!1,countdown:0,showClearIcon1:!1,showClearIcon2:!1,password:"password",eye:"eye"}),u=t.useUserStore(),i=r.useTimeStore(),l=o.useTagStore(),f=()=>{e.index.redirectTo({url:"../../pages/Home/Home"})},c=e=>{n.inputClearValue1=e.detail.value,e.detail.value.length>0?n.showClearIcon1=!0:n.showClearIcon1=!1},p=()=>{u.data.userName=null,n.showClearIcon1=!1},w=e=>{n.inputClearValue2=e.detail.value,e.detail.value.length>0?n.showClearIcon2=!0:n.showClearIcon2=!1},m=()=>{u.data.userCode=null,n.showClearIcon2=!1},C=()=>{"text"==n.password?n.password="password":"password"==n.password&&(n.password="text"),"eye"==n.eye?n.eye="eye-slash":"eye-slash"==n.eye&&(n.eye="eye")},g=()=>{n.userConfirm!=u.data.userPassword?e.index.showToast({icon:"none",title:"密码输入不一致"}):""==u.data.userCode?e.index.showToast({icon:"none",title:"请输入验证码"}):(e.index.request({url:s+"/user/sign",method:"POST",data:{userEmail:u.data.userEmail,userName:u.data.userName,userPassword:u.data.userPassword,userCode:u.data.userCode,ifUpdate:u.data.ifUpdate},success:a=>{console.log(a),null!=a.data.code?0==u.data.ifUpdate?e.index.redirectTo({url:"../../pages/index/Time"}):e.index.redirectTo({url:"../../pages/Home/Home"}):e.index.showToast({icon:"none",title:"验证码错误"}),u.data.ifUpdate=0}}),l.data.tagHour=1,l.data.tagMinute=30,i.data.remainingTime=3600*l.data.tagHour+60*l.data.tagMinute+l.data.tagSecond)};e.ref(0);const U=()=>{if(0===n.countdown){n.flag=!0,n.countdown=60;const a=setInterval((()=>{n.countdown--,0==n.countdown&&clearInterval(a)}),1e3);e.index.request({url:s+"/user/code",method:"POST",data:{userEmail:u.data.userEmail,ifUpdate:u.data.ifUpdate},success:e=>{console.log(e)}})}};return(t,r)=>e.e({a:a._imports_0$2,b:e.o(((...e)=>t.SignImageR&&t.SignImageR(...e))),c:!e.unref(u).data.ifUpdate},(e.unref(u).data.ifUpdate,{}),{d:!e.unref(u).data.ifUpdate},e.unref(u).data.ifUpdate?{}:{e:e.t(e.unref(u).data.userEmail),f:e.o(f)},{g:!e.unref(u).data.ifUpdate},(e.unref(u).data.ifUpdate,{}),{h:e.unref(u).data.ifUpdate},(e.unref(u).data.ifUpdate,{}),{i:e.unref(u).data.ifUpdate},e.unref(u).data.ifUpdate?{j:e.t(e.unref(u).data.userEmail),k:e.o(f)}:{},{l:e.unref(u).data.ifUpdate},(e.unref(u).data.ifUpdate,{}),{m:!e.unref(u).data.ifUpdate},e.unref(u).data.ifUpdate?{}:e.e({n:e.o([a=>e.unref(u).data.userName=a.detail.value,c]),o:e.unref(u).data.userName,p:n.showClearIcon1},n.showClearIcon1?{q:a._imports_2$3,r:e.o(p)}:{}),{s:n.password,t:e.unref(u).data.userPassword,v:e.o((a=>e.unref(u).data.userPassword=a.detail.value)),w:e.o(C),x:e.p({type:n.eye,size:"25"}),y:n.password,z:n.userConfirm,A:e.o((e=>n.userConfirm=e.detail.value)),B:e.o(C),C:e.p({type:n.eye,size:"25"}),D:e.o([a=>e.unref(u).data.userCode=a.detail.value,w]),E:e.unref(u).data.userCode,F:n.showClearIcon2},n.showClearIcon2?{G:a._imports_2$3,H:e.o(m)}:{},{I:a._imports_2$2,J:0===n.countdown},0===n.countdown?{}:{K:e.t(n.countdown)},{L:e.o(U),M:n.countdown>0,N:!e.unref(u).data.ifUpdate},e.unref(u).data.ifUpdate?{}:{O:e.o(g)},{P:e.unref(u).data.ifUpdate},e.unref(u).data.ifUpdate?{Q:e.o(g)}:{})}};wx.createPage(d);

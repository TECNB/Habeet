"use strict";const e=require("../../common/vendor.js"),t=require("../../common/assets.js"),o=require("../../store/user.js"),r=require("../../store/time.js"),s=require("../../store/store.js");if(!Array){e.resolveComponent("navbar")()}Math;const a={__name:"Store",setup(a){const i=e.inject("url"),d=o.useUserStore();r.useTimeStore();const n=s.useStoreStore(),u=e.reactive({storeWithTime:[],ifshowswiper:!1,ifshowStoreDetailNull:!1,currentswiper:0});e.onMounted((()=>{n.data.storeName="",n.data.storeDescribe="",n.data.storeHour=0,n.data.storeMinute=30,n.data.storePoint=1,n.data.ifStoreUpdate=0,e.index.request({url:i+"/store/get",method:"POST",data:d.data.userEmail,success:e=>{console.log(e);for(let t=0;t<e.data.data.length;t++)u.storeWithTime.push({storeName:e.data.data[t].storeName,storeDescribe:e.data.data[t].storeDescribe,storeHour:e.data.data[t].storeHour,storeMinute:e.data.data[t].storeMinute,storePoint:e.data.data[t].storePoint,storeId:e.data.data[t].storeId});1==e.data.data[0].ifStoreNull?(u.ifshowStoreDetailNull=!0,u.ifshowswiper=!1):(u.ifshowStoreDetailNull=!1,u.ifshowswiper=!0)}})}));const h=t=>{n.data.storeName=u.storeWithTime[t].storeName,n.data.storeDescribe=u.storeWithTime[t].storeDescribe,n.data.storeHour=u.storeWithTime[t].storeHour,n.data.storeMinute=u.storeWithTime[t].storeMinute,n.data.storePoint=u.storeWithTime[t].storePoint,n.data.ifStoreUpdate=1,n.data.storeId=u.storeWithTime[t].storeId,e.index.redirectTo({url:"../../pages/StoreCreat/StoreCreat"})};return(o,r)=>e.e({a:e.p({navbarTo:"/menu/4"}),b:u.ifshowswiper},u.ifshowswiper?{c:e.f(u.storeWithTime,((t,o,r)=>({a:e.o((e=>h(o)),o),b:e.t(t.storeName),c:e.t(t.storeDescribe),d:e.t(t.storeHour),e:e.t(t.storeMinute),f:e.o((e=>h(o)),o),g:e.t(t.storePoint),h:e.o((t=>(t=>{e.index.request({url:i+"/store/delete",method:"POST",data:{storeName:u.storeWithTime[t].storeName},success:o=>{console.log(o),1==o.data.data.ifEnough?(e.index.showToast({icon:"none",title:"兑换成功"}),u.storeWithTime.length--,0==u.storeWithTime.length&&(u.ifshowStoreDetailNull=!0,u.ifshowswiper=!1),u.storeWithTime.splice(t,1),d.data.point=o.data.data.storePoint):0==o.data.data.ifEnough&&e.index.showToast({icon:"none",title:"分数不足"})}})})(o)),o),i:o}))),d:t._imports_0$4,e:t._imports_4,f:e.o(((...e)=>o.changeswiper&&o.changeswiper(...e))),g:u.currentswiper}:{},{h:u.ifshowStoreDetailNull},u.ifshowStoreDetailNull?{i:t._imports_0$4}:{},{j:t._imports_3$1})}};wx.createPage(a);

"use strict";const a=require("../../common/vendor.js"),t=require("../../common/assets.js"),e=require("../../store/user.js"),d=require("../../store/time.js"),r=require("../../store/tag.js"),s=require("../../store/target.js"),i={__name:"Logo",setup(i){const g=a.inject("url"),o=e.useUserStore(),u=d.useTimeStore(),n=r.useTagStore(),l=s.useTargetStore(),m=a.reactive({currentswiper:0,targetNoTime:[],targetWithTime:[],targetCompleted:[],targetExpire:[],ifshowButton:!0,ifshowTargetTaskNull0:!1,ifshowTargetTaskNull1:!1,ifshowTargetTaskPAT:!1,ifshowTargetTaskPATDelete:!0,index:0});a.onMounted((()=>{o.data.userEmail="",a.index.getStorage({key:"userInfo",success:t=>{console.log(t.data),o.data.userInfo=t.data,console.log(o.data.userInfo),o.data.userEmail=t.data[1].userdatauserEmail,c(o.data.userInfo),a.index.getStorage({key:"userInfo",success:t=>{o.data.completeTarget=t.data[1].userdatacompleteTarget,o.data.picUrl=t.data[1].userdatapicUrl,o.data.point=t.data[1].userdatapoint,o.data.userName=t.data[1].userdatauserName,n.data.tagDescribe=t.data[2].tagdatatagDescribe,n.data.tagHour=t.data[2].tagdatatagHour,n.data.tagMinute=t.data[2].tagdatatagMinute,n.data.tagName=t.data[2].tagdatatagName,n.data.tagPoint=t.data[2].tagdatatagPoint,l.data.deadlineDate=t.data[3].targetdatadeadlineDate,setTimeout((()=>{a.index.redirectTo({url:"../../pages/index/Time"})}),500)}})},fail:t=>{setTimeout((()=>{a.index.redirectTo({url:"../../pages/Nav/Nav"})}),500)}})}));const c=t=>{o.data.userPassword="Wx",a.index.request({url:g+"/user/login",method:"POST",data:{userEmail:o.data.userEmail,userPassword:o.data.userPassword},success:a=>{o.data.userPassword="",null!=a.data.code&&(o.data.point=a.data.data.point,o.data.completeTarget=a.data.data.completeTarget,o.data.userName=a.data.data.userName,o.data.picUrl=a.data.data.picUrl,t[1].userdatauserEmail=o.data.userEmail,t[1].userdatapoint=o.data.point,t[1].userdatacompleteTarget=o.data.completeTarget,t[1].userdatauserName=o.data.userName,t[1].userdatapicUrl=o.data.picUrl)}}),a.index.request({url:g+"/tag/get",method:"POST",data:o.data.userEmail,success:a=>{console.log(a),n.data.tagName=a.data.data[0].tagName,n.data.tagDescribe=a.data.data[0].tagDescribe,n.data.tagPoint=a.data.data[0].tagPoint,n.data.tagHour=a.data.data[0].tagHour,n.data.tagMinute=a.data.data[0].tagMinute,t[2].tagdatatagName=n.data.tagName,t[2].tagdatatagDescribe=n.data.tagDescribe,t[2].tagdatatagPoint=n.data.tagPoint,t[2].tagdatatagHour=n.data.tagHour,t[2].tagdatatagMinute=n.data.tagMinute,u.data.remainingTime=3600*n.data.tagHour+60*n.data.tagMinute+n.data.tagSecond}}),a.index.request({url:g+"/target/get",method:"POST",data:{userEmail:o.data.userEmail,ifTargetUpdate:1},success:e=>{l.data.deadlineDate=[];for(let a=0;a<e.data.data.length;a++)if(0==e.data.data[a].status)m.targetNoTime.push({targetName:e.data.data[a].targetName,targetDescribe:e.data.data[a].targetDescribe,targetPoint:e.data.data[a].targetPoint,deadline:e.data.data[a].deadline,targetId:e.data.data[a].targetId});else if(1==e.data.data[a].status){let t=new Date(e.data.data[a].deadline);l.data.deadlineDate.includes(t)||l.data.deadlineDate.push(t),m.targetWithTime.push({targetName:e.data.data[a].targetName,targetDescribe:e.data.data[a].targetDescribe,targetPoint:e.data.data[a].targetPoint,deadline:e.data.data[a].deadline,targetId:e.data.data[a].targetId})}t[3].statetargetNoTime=m.targetNoTime,t[3].statetargetWithTime=m.targetWithTime,t[3].targetdatadeadlineDate=l.data.deadlineDate,a.index.setStorage({key:"userInfo",data:o.data.userInfo})}})};return(a,e)=>({a:t._imports_0,b:t._imports_1,c:t._imports_2})}};wx.createPage(i);
